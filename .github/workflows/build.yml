name: Build Android APK
on: [push, workflow_dispatch]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4  # è¿™é‡Œæ”¹æˆäº† v4

      - name: Setup Java
        uses: actions/setup-java@v4 # è¿™é‡Œæ”¹æˆäº† v4
        with:
          java-version: '17'
          distribution: 'temurin'

      - name: Setup Qt
        uses: jurplel/install-qt-action@v3 # è¿™ä¸ªæ’ä»¶ä¿æŒ v3 å³å¯ï¼Œå®ƒæ˜¯ç›®å‰æœ€ç¨³å®šçš„
        with:
          version: '6.5.0'
          target: 'android'
          arch: 'android_arm64_v8a'

      - name: Build APK
        run: |
          mkdir build_temp
          cd build_temp
          qt-cmake ..
          cmake --build . --parallel
          # æŸ¥æ‰¾ç”Ÿæˆçš„ apk å¹¶å¤åˆ¶å‡ºæ¥
          find . -name "*.apk" -exec cp {} app-release.apk \;

      - name: Upload Artifact
        uses: actions/upload-artifact@v4 # ğŸ”´ è¿™é‡Œæ˜¯å…³é”®ä¿®æ”¹ï¼šå¿…é¡»æ˜¯ç”¨ v4
        with:
          name: My-Android-App
          path: build_temp/app-release.apk
          compression-level: 0 # v4 æ–°å¢é€‰é¡¹ï¼Œ0 è¡¨ç¤ºä¸å‹ç¼©ç›´æ¥ä¸Šä¼ ï¼Œé€Ÿåº¦å¿«
